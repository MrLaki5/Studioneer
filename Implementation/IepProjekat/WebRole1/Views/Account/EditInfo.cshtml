
@{
    ViewBag.Title = "EditInfo";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .hid {
        display:none;
    }
</style>
<h2>EditInfo</h2><div class="dropdown">
    <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">
        Dropdown Example
        <span class="caret"></span>
    </button>
    <ul class="dropdown-menu">
        <li>Change Email</li>
        <li>Change Username</li>
        <li>Change Password</li>
    </ul>
</div>
<form id="Forma">
    @Html.AntiForgeryToken()
    <!--<h4>Create a new account</h4>   -->
    <hr />
    @Html.ValidationSummary("", new { @class = "text-danger center" })

    <div id="emailBox" class="form-group hid">
        @Html.Label("Email:")
        @Html.TextBox("email", null, new { @class = "form-control", @name = "email", @type = "email" })
    </div>

    <div id="usernameBox" class="form-group hid">
        @Html.Label("Username:")
        @Html.TextBox("name", null, new { @class = "form-control", @name = "name" })
    </div>

    <div id="oldPasswordBox" class="form-group hid">
    @Html.Label("Old password:")
    @Html.TextBox("opassword", null, new { @class = "form-control", @type = "password", @name = "opassword" })
    </div>

    <div id="newPasswordBox" class="form-group hid">
        @Html.Label("New password:")
        @Html.TextBox("password", null, new { @class = "form-control", @type = "password", @name = "password" })
    </div>

    <div id="cpasswordBox" class="form-group hid">
        @Html.Label("Confirm password:")
        @Html.TextBox("cpassword", null, new { @class = "form-control", @type = "password", @name = "cpassword" })
    </div>

    <div id="dugme" class="form-group hid">
        <input type="submit" class="btn btn-default" id="butt1" value="Update Information" />
    </div>
    <div class="form-group">
        @Html.Label(" ", new { id = "result" })
    </div>
</form>

<script src="~/Scripts/jquery-1.10.2.js" type="text/javascript"></script>
<script type="text/javascript">

   
    $(document).ready(function () {

        var pravila = '';

        $("li:first-child").on("click", function () {
            $("#emailBox").removeClass("hid");
            $("#oldPasswordBox").removeClass("hid");
            $("#dugme").removeClass("hid");
            $("#usernameBox").addClass("hid");
            $("#newPasswordBox").addClass("hid");
            $("#cpasswordBox").addClass("hid");
            pravila = '';
            return pravila = {
                rules: {
                    email: {
                        required: true,
                        email: true
                    },
                    opassword: {
                        required: true,
                        minlength: 6
                    }
                },
                messages: {

                    email: {
                        required: "We need your email address to contact you",
                        email: "Your email address must be in the format of name@domain.com"
                    },
                    opassword: {
                        required: "Please provide a password",
                        minlength: "Your password must be at least 6 characters long"
                    }
                    
                }
            }

            
        });
        $("li:nth-child(2)").on("click", function () {
            $("#usernameBox").removeClass("hid");
            $("#oldPasswordBox").removeClass("hid");
            $("#dugme").removeClass("hid");
            $("#emailBox").addClass("hid");
            $("#newPasswordBox").addClass("hid");
            $("#cpasswordBox").addClass("hid");
            pravila = '';
            return pravila = {
                rules: {
                    name: "required",
                    
                    opassword: {
                        required: true,
                        minlength: 6
                    }
                    
                },
                messages: {
                    name: "Please specify your name",
                    
                    opassword: {
                        required: "Please provide a password",
                        minlength: "Your password must be at least 6 characters long"
                    }
                    
                }
            };
        });
        $("li:nth-child(3)").on("click", function () {
            
            $("#oldPasswordBox").removeClass("hid");
            $("#newPasswordBox").removeClass("hid");
            $("#cpasswordBox").removeClass("hid");
            $("#dugme").removeClass("hid");
            $("#emailBox").addClass("hid");
            $("#usernameBox").addClass("hid");
            pravila = '';
            return pravila = {
                rules: {
                    opassword: {
                        required: true,
                        minlength: 6
                    },
                    password: {
                        required: true,
                        minlength: 6
                    },
                    cpassword: {
                        required: true,
                        minlength: 6,
                        equalTo: '#password'
                    }
                },
                messages: {

                    password: {
                        required: "Please provide a password",
                        minlength: "Your password must be at least 6 characters long"
                    },
                    opassword: {
                        required: "Please provide a password",
                        minlength: "Your password must be at least 6 characters long"
                    },
                    cpassword: {
                        required: "Please provide a password",
                        minlength: "Your password must be at least 6 characters long",
                        equalTo: "Password does not match!"
                    }
                }
            };
        });

        

        $("#Forma").validate(pravila).submit(function () {
            var Email = $('#email').val();
            var Name = $('#name').val();
            var Password = $('#password').val();
            var Cpassword = $('#cpassword').val();

            $.ajax({
                type: "POST",
                data: {email: Email, name: Name, password: Password, cpassword: Cpassword},
                url: '@Url.Action("EditInfo","Account")',
                success: function (result) {
                    $('#result').html(result);
if (new String("Created").valueOf() == new String(result).valueOf()) {
                        window.location = "@Url.Action("Login", "Account")";
                    }
                }
            });
        });
    });
</script>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
